Village of Words: 로컬 LLM 기반 자율 NPC 사회 실험
실행 계획 및 운영 지침

Ⅰ. 실험 목표
- CLI 기반 다중 에이전트 협력 시뮬레이션 구현 및 재현성 확보
- 협력 형성→붕괴→회복의 정량 지표 수집(협력 비율, 회복 시간 등)
- LM Studio 로컬 LLM 조합의 성능/안정성 검증 및 로그 자동화

Ⅱ. 환경 및 도구 준비
- OS: WSL Ubuntu (python3, python3-venv, python3-pip 설치)
- 가상환경: `python3 -m venv .venv && source .venv/bin/activate`
- 필수 패키지 초안: `pip install pytest numpy pandas rich typer`
- 모델: LM Studio 로컬 서버 (기본 4개 포트, 예시 9001~9004)
- 버전 관리: Git + Conventional Commits, 실험별 브랜치 권장

Ⅲ. 데이터/리소스 구조
- `data/raw/`: 프롬프트 템플릿, 초기 세계 상태 JSON
- `data/processed/`: 전처리 결과 (`state_init.json`, `scenario_turns.json`)
- `experiments/vow-baseline/`: 설정/스크립트/요약 (baseline 확장시 복제)
- `results/vow-baseline/`: 실행 로그(`events.jsonl`), 지표(`metrics.json`), 그래프(`plots/`)

Ⅳ. 에이전트 정의
- 인원: 4 (A,B,C,D) — 기본 역할/성향 JSON (`agents_seed.json`)
- 공통 프롬프트 구조: THOUGHT/DECISION/MESSAGE 필드 강제
- 상태 저장: `AgentManager`가 메모리/자원/관계 스냅샷 관리
- 배신 조건: (1) 자원 미기여 (2) 메시지-행동 불일치

Ⅴ. 시나리오 타임라인
1. 초기화(턴 0): 자원 균등 배분, 집단 목표 주입, 룰 브리핑
2. 형성(턴 1-3): 협력을 강제, 기록 벤치마크 수집
3. 자율 전환(턴 4-6): 배신 허용, 자율 선택 관찰
4. 충격 이벤트(턴 7): 자원 감소/규칙 변경 중 1가지 삽입
5. 회복 관찰(턴 8-10): 자율 협력 회복 여부 기록

Ⅵ. 로깅 및 지표 산출
- 로그 포맷: `events.jsonl` (timestamp, agent, thought, decision, message, action, resources)
- 지표 계산 스크립트: `python -m src.metrics --events results/.../events.jsonl`
- 산출 지표: 협력 비율, 평균 기여, 회복 시간, Gini 계수, 대화량 편중도
- 시각화: `python -m src.plots --metrics results/.../metrics.json`

Ⅶ. 실행 절차
1. 전처리: `python -m src.preprocess --config experiments/.../config.yaml`
2. 실험 수행: `python -m src.run --config experiments/.../config.yaml --seed 42`
3. 지표 계산: `python -m src.metrics --config experiments/.../config.yaml`
4. 결과 정리: `python -m src.report --config ... --out results/.../SUMMARY.md`
5. 재현성 기록: `pip freeze > experiments/.../requirements.lock`

Ⅷ. 검증 및 리스크 대응
- 테스트: `pytest`로 핵심 컴포넌트 단위테스트 (AgentManager, Evaluator 등)
- 예외 시나리오: LM Studio 응답 지연 → 타임아웃 30초, 재시도 2회
- 로그 실패 시 즉시 중단하고 상태 스냅샷(`crash_state.json`) 저장
- 협력 붕괴 미발생 시 충격 이벤트 강도를 조정하고 재실행

Ⅸ. 산출물/보고
- `results/<name>/SUMMARY.md`: 주요 지표/인사이트/이슈
- `docs/experiments_<date>.md`: 실험별 회고 (선택)
- 논문 반영: 지표 표/도표를 LaTeX 혹은 Markdown 테이블로 정리
